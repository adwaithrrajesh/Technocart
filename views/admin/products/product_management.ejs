<body>
    <%- include('../layouts/layout') -%>
    <div class="container-scroller">
      <!-- partial:../../partials/_sidebar.html -->
      <%- include('../partials/sidebar') -%>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:../../partials/_navbar.html -->
      <%- include('../partials/navbar') -%>
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
            <div class="page-header">
              <h3 class="page-title"> Product Management </h3>
            </div>
            <div class="row">
              <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Products</h4>
                    </p>
                    <div class="table-responsive">
                      <table class="table table-dark" id="Refresh">
                        <thead>
                          <tr>
                            <th> Product Image</th>
                            <th>Product Name</th>
                            <th></th>
                            <th>Price</th> 
                            <th></th> 
                            <th>Category</th> 
                            <th>Edit</th>
                            <th></th>
                            <th> Action </th>
                          </tr>
                        </thead>
                        <tbody>
                          <% products_view.forEach(function(product) { %>
                            <tr>
                              <td><img src="/images/products/<%=product.Image[0].filename %>" alt="" style="width: 150px; height: 150px;"/></td>
                              <td><%= product.ProductName %></td>
                              <td></td>
                              <td>$<%= product.Price%></td>
                              <td></td>
                              <td><%= product.Category%></td>
                              <!-- <td></td> -->
                              <td>
                                <form action="/admin/edit_product/<%=product._id%>" method="post">
                                <button type="submit" class="btn btn-primary"><i class="mdi mdi-pencil"></i></button>
                                </form>
                              </td> 
                              <td></td>
                              <td>
                                <% if(product.Allow){ %>
                                    <button class="btn btn-success" onclick="Hide('<%=product._id%>')"><i class="mdi mdi-close"></i></button>
                                <% } else{ %>  
                                  <button class="btn btn-danger" onclick="Show('<%=product._id%>')"><i class="mdi mdi-checkbox-marked-circle"></i></button>
                               <% } %>
                            </td>
                            </tr>
                         <% }); %> 
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>

  <script>
    function Hide(Product) {
        $.ajax({
          url: "/admin/hide_product",
          data: {
            Product
          },
          method: "post",
          success: (response) => {
              $('#Refresh').load(location.href+" #Refresh>*","")
          },
        });
      }
      function Show(Product) {
        $.ajax({
          url: "/admin/show_product",
          data: {
            Product
          },
          method: "post",
          success: (response) => {
              $('#Refresh').load(location.href+" #Refresh>*","")
          },
        });
      }
  </script>
